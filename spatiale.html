<!DOCTYPE html>
<html lang="en"><!-- Basic -->
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">   
   
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
 
     <!-- Site Metas -->
	 <title>Géoportail Touristique du Maroc</title>  
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="images/palmicon.png" 
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">    
	<!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css">    
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">

	<script src="rivers.geojson"></script>

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>
	<!-- Start header -->
	<header class="top-navbar">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<div class="container">
				<a class="navbar-brand" href="index.html">
					<img src="images/logogeotourisme.png" alt="" />
				</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbars-rs-food" aria-controls="navbars-rs-food" aria-expanded="false" aria-label="Toggle navigation">
				  <span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbars-rs-food">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item"><a class="nav-link" href="index.html">Accueil</a></li>
						<li class="nav-item"><a class="nav-link" href="about.html">Informations</a></li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Evolution</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="blog.html">Tourisme National</a>
								<a class="dropdown-item" href="blog-details.html">Tourisme International</a>
							</div>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Zones touristiques</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="reservation.html">Monuments historiques</a>
								<a class="dropdown-item" href="stuff.html">Rivières</a>
								<a class="dropdown-item" href="temp.html">Températures</a>
							</div>
						</li>
						<li class="nav-item active dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Requête</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="attributaire.html">Attributaires</a>
								<a class="dropdown-item" href="spatiale.html">Spatiales</a>
							</div>
						</li>
						<li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
	<!-- End header -->
	
	<!-- Start All Pages -->
	<div class="all-page-title page-breadcrumb">
		<div class="container text-center">
			<div class="row">
				<div class="col-lg-12">
					<h1>Requêtes Spatiales</h1>
				</div>
			</div>
		</div>
	</div>
	<!-- End All Pages -->
	<div class="blog-box">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="heading-title text-center">
						<h2>Carte représentant les monuments les plus visités par région :</h2>
						<p>  </p>
				<head>
				  <meta charset="utf-8" />
				  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
				  <title>Esri Leaflet</title>
			  
				  <!-- Load Leaflet from CDN -->
				  <link
					rel="stylesheet"
					href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
					integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
					crossorigin=""
				  />
				  <script
					src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
					integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
					crossorigin=""
				  ></script>
			  
				  <!-- Load Esri Leaflet from CDN -->
				  <script src="https://unpkg.com/esri-leaflet@3.0.4/dist/esri-leaflet.js"></script>
				  <script src="https://unpkg.com/esri-leaflet-vector@3.0.0/dist/esri-leaflet-vector.js"></script>
			  
				  <link
				  rel="stylesheet"
				  href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
				  integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
				  crossorigin=""
					/>
					<script
					src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
					integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
					crossorigin=""
					></script>
			
					<!-- Load Esri Leaflet from CDN -->
					<script src="https://unpkg.com/esri-leaflet@3.0.4/dist/esri-leaflet.js"></script>
					<script src="https://unpkg.com/esri-leaflet-vector@3.0.0/dist/esri-leaflet-vector.js"></script>
			
			
					<!-- Load Esri Leaflet Geocoder from CDN -->
					<link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@3.0.0/dist/esri-leaflet-geocoder.css"">
					<script src="https://unpkg.com/esri-leaflet-geocoder@3.0.0/dist/esri-leaflet-geocoder.js"></script>
					<link rel="stylesheet" href="https://js.arcgis.com/4.22/esri/themes/light/main.css" />
			
					<style>
						#map {
						width: 700px;
						height: 500px;
						font-family: Arial, Helvetica, sans-serif;
						font-size: 14px;
						color: #323232;
						}
					</style>

				</head>
			  
				<body>
				  <center>
					  <div id="map"></div> </center>
			  
				  <script>
			  
					const apiKey = "AAPK809673f41dd244d78ff03d9ee4dd9b34j2hpPLSH66Z0qD7XyiiYDQvgyo3e_iOgMMJL6PVYRGLAt8PJ0_09EGoou2H95WkB";
			  
			  
					const map = L.map('map').setView([29.638933, -9.665423], 5);
					L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
           attribution: 'Map tiles by Carto, under CC BY 3.0. Data by OpenStreetMap, under ODbL.',
           maxZoom: 11,
           minZoom: 4
         }).addTo(map);
		
			  
					// L.esri.Vector.vectorBasemapLayer(basemapEnum, {
					//   apiKey: apiKey
					// }).addTo(map);
			  
					
					const searchControl = L.esri.Geocoding.geosearch({
					position: "topleft",
					placeholder: "Chercher une adresse ou un endroit :",
					useMapBounds: false,
					providers: [
					  L.esri.Geocoding.arcgisOnlineProvider({
						apikey: apiKey,
						nearby: {
						  lat: -33.8688,
						  lng: 151.2093
						}
					  })
					]
				  }).addTo(map);
			
				  const results = L.layerGroup().addTo(map);
			
				  searchControl.on("results", (data) => {
					results.clearLayers();
					for (let i = data.results.length - 1; i >= 0; i--) {
					  const lngLatString = `${Math.round(data.results[i].latlng.lng * 100000) / 100000}, ${
						Math.round(data.results[i].latlng.lat * 100000) / 100000
					  }`;
					  const marker = L.marker(data.results[i].latlng);
					  marker.bindPopup(`<b>${lngLatString}</b><p>${data.results[i].properties.LongLabel}</p>`);
					  results.addLayer(marker);
					  marker.openPopup();
					}
				  });

				  
				  var regions = L.esri.featureLayer({
							url: "https://services3.arcgis.com/RYJD4BItRgLmP5Zw/arcgis/rest/services/regions/FeatureServer/0",
								style: {
								color: '#74c476',
								weight: 1,
								opacity: 1
								}
							}).addTo(map);
			  
					// Create the select dropdown and add to the top-right of the map
					L.Control.QueryControl = L.Control.extend({
					  onAdd: function (map) {
						// Array of query where clauses
						const whereClauses = [
						  "Afficher les monuements de la région :",
			
						  "region = 'Casablanca-Settat'",
						  "region = 'Rabat-Salé-Kénitra'",
						  "region = 'Fes-Meknès'",
						  "region = 'Tanger-Tétouan-Al Hoceima'",
						  "region = 'Marrakech-Safi'",
						  "region = 'Oriental'",
						  "region = 'Drâa-Tafilalet'"
			
						  
						];
			
			
						// Create select
						const select = L.DomUtil.create("select", "");
						select.setAttribute("id", "whereClauseSelect");
						select.setAttribute("style", "font-size: 16px;padding:4px 8px;");
						whereClauses.forEach(function (whereClause) {
						  let option = L.DomUtil.create("option");
						  option.innerHTML = whereClause;
						  select.appendChild(option);
						});
						return select;
					  },
			  
					  onRemove: function (map) {
						// Nothing to do here
					  }
					});
			  
					L.control.queryControl = function (opts) {
					  return new L.Control.QueryControl(opts);
					};
			  
					L.control
					  .queryControl({
						position: "bottomright"
					  })
					  .addTo(map);
			  
				  // Style trailheads (points)
				  const icon = L.icon({
					iconUrl: "http://static.arcgis.com/images/Symbols/PeoplePlaces/esriBusinessMarker_59_Yellow.png",
					iconSize: [30, 35]
				  });
			
			
					// Add the Feature Layer to the map
					const parcels = L.esri
					  .featureLayer({
						url: "https://services3.arcgis.com/RYJD4BItRgLmP5Zw/arcgis/rest/services/monuments/FeatureServer/0",
						simplifyFactor: 0.5,
						precision: 4,
						where: "1 = 0",
						pointToLayer: (geojson, latlng) => {
						return L.marker(latlng, {
						  icon: icon
						});
						}
						
						})
					  .addTo(map);


					 // L.marker(clickCoords, {icon: uniIcon}).addTo(myLocation);
			
			
					//Setup the Popup
					parcels.bindPopup(function (layer) {
					return L.Util.template("<b>Région : {region}</b>" + " </br> Monument: {Monument}", layer.feature.properties);
					});
			  
					// When the selected where clause changes, set the filter on the layer
					const select = document.getElementById("whereClauseSelect");
					select.addEventListener("change", () => {
					  if (select.value !== "") {
						parcels.setWhere(select.value);
					  }
					});

				  </script>
				</body>
			  </html>
	
	<a href="#" id="back-to-top" title="Back to top" style="display: none;">&uarr;</a>

	<!-- ALL JS FILES -->
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
	<script src="js/jquery.superslides.min.js"></script>
	<script src="js/images-loded.min.js"></script>
	<script src="js/isotope.min.js"></script>
	<script src="js/baguetteBox.min.js"></script>
	<script src="js/form-validator.min.js"></script>
    <script src="js/contact-form-script.js"></script>
    <script src="js/custom.js"></script>
</body>
</html>