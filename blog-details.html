<!DOCTYPE html>
<html lang="en"><!-- Basic -->
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">   
   
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
 
     <!-- Site Metas -->
	 <title>Géoportail Touristique du Maroc</title>  
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="images/palmicon.png" 
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">    
	<!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css">    
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>
	<!-- Start header -->
	<header class="top-navbar">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<div class="container">
				<a class="navbar-brand" href="index.html">
					<img src="images/logogeotourisme.png" alt="" />
				</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbars-rs-food" aria-controls="navbars-rs-food" aria-expanded="false" aria-label="Toggle navigation">
				  <span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbars-rs-food">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item"><a class="nav-link" href="index.html">Accueil</a></li>
						<li class="nav-item"><a class="nav-link" href="about.html">Informations</a></li>
						<li class="nav-item active dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Evolution</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="blog.html">Tourisme National</a>
								<a class="dropdown-item" href="blog-details.html">Tourisme International</a>
							</div>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Zones Touristiques</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="reservation.html">Monuments Historiques</a>
								<a class="dropdown-item" href="stuff.html">Rivières</a>
								<a class="dropdown-item" href="temp.html">Températures</a>
							</div>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Requêtes</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="attributaire.html">Attributaires</a>
								<a class="dropdown-item" href="spatiale.html">Spatiales</a>
							</div>
						</li>
						<li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
	<!-- End header -->
	
	<!-- Start All Pages -->
	<div class="all-page-title page-breadcrumb">
		<div class="container text-center">
			<div class="row">
				<div class="col-lg-12">
					<h1>Tourisme International</h1>
				</div>
			</div>
		</div>
	</div>
	<!-- End All Pages -->
	<div class="blog-box">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="heading-title text-center">
						<h2>Carte représentant les pourcentages d'arrivée des touristes internationaux au niveau de chaque région :</h2>
						<p> N.B : Cette représentation concerne seulement les arrivées des trouistes au niveau des établissement classés.</p>
					</div>
				</div>
			</div>
	
	<html>
		<head>
	
			<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
			integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
			crossorigin=""/>
			<link rel="stylesheet" href="css/style2.css">
			<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
			integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
			crossorigin=""></script>
	
			<script src="https://code.jquery.com/jquery-3.5.1.min.js"
			integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
			crossorigin="anonymous"></script>
	
			<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
			integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
			crossorigin="anonymous"></script>
	
			<style type="text/css">
			  html, body { margin: 0px; padding: 1; height: 100%; }
			  #map  {
					  width: 600px;
					  height: 580px;
					  margin: 15px auto
					}
			  
			</style>
	
		</head>
	
		<body>
	
			</div>
			<div id="map"></div>
			<script type="text/javascript" src="js/regions.js"></script>
			<script type="text/javascript">
			$(document).ready(function() {
	
			  var map = L.map('map').setView([30.047222, -8.706566], 5);
	
			  L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
           attribution: 'Map tiles by Carto, under CC BY 3.0. Data by OpenStreetMap, under ODbL.',
           maxZoom: 11,
           minZoom: 4
         }).addTo(map);
	
			  
			  function Monstyle(feature) {
				return {
				  weight: 1,
				  opacity: 1,
				  color: '#5a5e5f',
				  dashArray: '3',
				  fillOpacity: 0.8,
				  fillColor: '#ffffd4'
				};
			  } 
	
			  var geojson = L.geoJson(regions, {
				style: Monstyle}).addTo(map);
	
			 //Upload Geojson File
			 
				$.getJSON("https://raw.githubusercontent.com/ekholoud/website/main/tourisme.geojson")
				.done(function(data) {
					var info = processData(data);
					createPropSymbols(info.timestamps, data);
			  createLegend(info.min,info.max);
					createSliderUI(info.timestamps);
			  
				});
	
			// Process Data
			function processData(data) {
			  
			  var timestamps = [];  
			  var	min = Infinity; 
			  var	max = -Infinity;
	
			  
			  for (var feature in data.features) {
				  var properties = data.features[feature].properties;
	
				  
				  for (var attribute in properties) {
					  if ( attribute != 'FID_' &&
						   attribute != 'Id' &&
						   attribute != 'Nom' &&
						   attribute != 'Lat' &&
						   attribute != 'Lon' )   
					  {
						  if ( $.inArray(attribute,timestamps) ===  -1) { 
															
	
							  timestamps.push(attribute);  
						  }
						  if (properties[attribute] < min) {
							  min = properties[attribute]; 
						  }
						  if (properties[attribute] > max) {
							  max = properties[attribute]; 
						  }
					  }
				  }
			  }
			  return { 
				  timestamps : timestamps,
				  min : min,
				  max : max
			  }
			}
	
			// Create Propotional Symbols
			function createPropSymbols(timestamps, data) {
	
			  regions = L.geoJson(data, {
	
				  
				  pointToLayer: function(feature, latlng) {
					  return L.circleMarker(latlng, { // we use circle marker for the points
						  fillColor: "#cc4c02",  // fill color of the circles
						  color: '#cc4c02',      // border color of the circles
						  weight: 1,             // circle line weight in pixels
						  fillOpacity: 0.5       // fill opacity (0-1)
					  }).on({
							mouseover: function(e) {
								this.openPopup();
								this.setStyle({fillColor: 'black'});  // fill color turns black when mouseover
							},
							mouseout: function(e) {
								this.closePopup();
								this.setStyle({fillColor: '#cc4c02'});  // fill turns original color when mouseout
							}
					});
				  }
			  }).addTo(map);
	
			  updatePropSymbols(timestamps[0]); 
			}
	
			// Update Propotional Symbols
			function updatePropSymbols(timestamp) {
	
			  regions.eachLayer(function(layer) {  
	
				  var props = layer.feature.properties;  
				  var radius = calcPropRadius(props[timestamp]); 
	
				  
				  var popupContent = '<b> Région : <b>' + props.Nom + '</b> <br />Total des touristes : ' + String(props[timestamp]) ;
	
				  layer.setRadius(radius);  
				  layer.bindPopup(popupContent, { offset: new L.Point(0,-radius), autoPan: false }); 
			  });
			}
	
			
			function calcPropRadius(attributeValue) {
	
			  var scaleFactor = 0.001;   
			  var area = attributeValue * scaleFactor;
	
			  return Math.sqrt(area/Math.PI);  
			}
	
	
			function createLegend(min, max) {
					if (min < 200000) { 
						min = 200000; 
					}
					if (max > 800000) { 
						max = 2000000; 
					}
	
					function roundNumber(inNumber) {
						 return (Math.round(inNumber/10) * 10);
					}
					var legend = L.control( { position: 'bottomright'} );    
					legend.onAdd = function(map) {
	
					var legendContainer = L.DomUtil.create("div", "legend");
					var symbolsContainer = L.DomUtil.create("div", "symbolsContainer");
					var classes = [roundNumber(min), roundNumber((max-min)/2), roundNumber(max)]; 
					var legendCircle;
					var lastRadius = 0;
					var currentRadius;
					var margin;
					L.DomEvent.disableClickPropagation(legendContainer);; 
					$(legendContainer).append("<h3 id='legendTitle'>Nombre de touristes par région</h3>");
					
	
					for (var i = 0; i <= classes.length-1; i++) {
	
						legendCircle = L.DomUtil.create("div", "legendCircle");
						currentRadius = calcPropRadius(classes[i]);
						margin = -currentRadius - lastRadius - 2;
						$(legendCircle).attr("style", "width: " + currentRadius*2 +
							"px; height: " + currentRadius*2 + 
							"px; margin-left: " + margin + "px" );
						$(legendCircle).append("<span class='legendValue'>"+ classes[i] +"</span>");
						$(symbolsContainer).append(legendCircle);
						lastRadius = currentRadius;
					}
					$(legendContainer).append(symbolsContainer);
					return legendContainer; 
					};
					legend.addTo(map);} // end createLegend() 
	
	
	
		// Creation of the Slider
			function createSliderUI(timestamps) {
			  var sliderControl = L.control({ position: 'bottomleft'} ); 
			  sliderControl.onAdd = function(map) {
				
				  var slider = L.DomUtil.create("input", "range-slider");
				  L.DomEvent.addListener(slider, 'mousedown', function(e) {
					  L.DomEvent.stopPropagation(e);
				  });
	
				var labels = ["2018","2020"];
	
				$(slider)
					.attr({
					  'type':'range',
					  'max': timestamps[timestamps.length-1],
					  'min':timestamps[0],
					  'step': 1, 
					  'value': String(timestamps[0])})
					.on('input change', function() {
						updatePropSymbols($(this).val().toString()); 
						var i = $.inArray(this.value,timestamps);
						$(".temporal-legend").text(labels[i]); 
					});
				return slider;
			  }
			  sliderControl.addTo(map);
			  createTimeLabel("2018"); 
			  }
	
	
		  // Create a Legend for the Slider
	
			  function createTimeLabel(startTimestamp) {
				var temporalLegend = L.control({position: 'bottomleft' }); 
				temporalLegend.onAdd = function(map) {
				  var output = L.DomUtil.create("output", "temporal-legend");
				  $(output).text(startTimestamp);
				  return output;
				}
				temporalLegend.addTo(map);
			  }
	
	
	
	
			});
	
			</script>
	   </body>
	</html>

	
	<a href="#" id="back-to-top" title="Back to top" style="display: none;">&uarr;</a>

	<!-- ALL JS FILES -->
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
	
	<script src="js/jquery.superslides.min.js"></script>
	<script src="js/images-loded.min.js"></script>
	<script src="js/isotope.min.js"></script>
	<script src="js/baguetteBox.min.js"></script>
	<script src="js/form-validator.min.js"></script>
    <script src="js/contact-form-script.js"></script>
    <script src="js/custom.js"></script>
</body>
</html>